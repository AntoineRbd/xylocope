const $=t=>document.querySelector(t),$$=t=>document.querySelectorAll(t),ready=t=>{"loading"!==document.readyState?t():document.addEventListener("DOMContentLoaded",t)},debounce=(t,e,o)=>{let n;return function(...i){const s=o&&!n;clearTimeout(n),n=setTimeout(()=>{n=null,o||t(...i)},e),s&&t(...i)}},throttle=(t,e)=>{let o;return function(...n){o||(t.apply(this,n),o=!0,setTimeout(()=>o=!1,e))}},scrollToElement=(t,e=0)=>{const o=t.offsetTop-e;window.scrollTo({top:o,behavior:"smooth"})},getOffset=t=>{let e=0;for(;t;)e+=t.offsetTop,t=t.offsetParent;return e},isInViewport=t=>{const e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},observeElements=(t,e,o={})=>{const n={root:null,rootMargin:"0px",threshold:.1,...o},i=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(e(t.target),i.unobserve(t.target))})},n);return t.forEach(t=>i.observe(t)),i},validators={email:t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),phone:t=>/^[+]?[1-9][\d]{0,15}$/.test(t.replace(/\s/g,"")),required:t=>t.trim().length>0,minLength:(t,e)=>t.trim().length>=e,maxLength:(t,e)=>t.trim().length<=e},setLoadingState=(t,e)=>{e?(t.classList.add("loading"),t.style.position="relative"):t.classList.remove("loading")},showNotification=(t,e="info",o=5e3)=>{const n=$(".notification");n&&n.remove();const i=document.createElement("div");if(i.className=`notification notification--${e}`,i.innerHTML=`\n        <div class="notification__content">\n            <span class="notification__message">${t}</span>\n            <button class="notification__close" aria-label="Fermer">&times;</button>\n        </div>\n    `,!$("#notification-styles")){const t=document.createElement("style");t.id="notification-styles",t.textContent="\n            .notification {\n                position: fixed;\n                top: 20px;\n                right: 20px;\n                z-index: 10000;\n                max-width: 400px;\n                padding: 1rem;\n                border-radius: 8px;\n                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n                transform: translateX(100%);\n                transition: transform 0.3s ease;\n            }\n            .notification--info { background: #007bff; color: white; }\n            .notification--success { background: #28a745; color: white; }\n            .notification--warning { background: #ffc107; color: #212529; }\n            .notification--error { background: #dc3545; color: white; }\n            .notification.show { transform: translateX(0); }\n            .notification__content { display: flex; align-items: center; justify-content: space-between; }\n            .notification__close { background: none; border: none; color: inherit; font-size: 1.5rem; cursor: pointer; margin-left: 1rem; }\n        ",document.head.appendChild(t)}document.body.appendChild(i),setTimeout(()=>i.classList.add("show"),100);i.querySelector(".notification__close").addEventListener("click",()=>{i.classList.remove("show"),setTimeout(()=>i.remove(),300)}),o>0&&setTimeout(()=>{i.parentNode&&(i.classList.remove("show"),setTimeout(()=>i.remove(),300))},o)},storage={set:(t,e)=>{try{localStorage.setItem(t,JSON.stringify(e))}catch(t){console.warn("Could not save to localStorage:",t)}},get:(t,e=null)=>{try{const o=localStorage.getItem(t);return o?JSON.parse(o):e}catch(t){return console.warn("Could not read from localStorage:",t),e}},remove:t=>{try{localStorage.removeItem(t)}catch(t){console.warn("Could not remove from localStorage:",t)}},clear:()=>{try{localStorage.clear()}catch(t){console.warn("Could not clear localStorage:",t)}}},api={async request(t,e={}){const o={headers:{"Content-Type":"application/json"},...e};try{const e=await fetch(t,o);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=e.headers.get("content-type");return n&&n.includes("application/json")?await e.json():await e.text()}catch(t){throw console.error("API request failed:",t),t}},get(t,e={}){return this.request(t,{...e,method:"GET"})},post(t,e,o={}){return this.request(t,{...o,method:"POST",body:JSON.stringify(e)})},put(t,e,o={}){return this.request(t,{...o,method:"PUT",body:JSON.stringify(e)})},delete(t,e={}){return this.request(t,{...e,method:"DELETE"})}};window.Utils={$:$,$$:$$,ready:ready,debounce:debounce,throttle:throttle,scrollToElement:scrollToElement,getOffset:getOffset,isInViewport:isInViewport,observeElements:observeElements,validators:validators,setLoadingState:setLoadingState,showNotification:showNotification,storage:storage,api:api};const config=window.XylocopeConfig;class XylocopeModern{constructor(){this.allVideos=[...config.VIDEOS],this.images=[...config.IMAGES],this.currentVideoIndex=0,this.shuffledVideos=[...this.allVideos].sort(()=>Math.random()-.5),this.isAutoPlaying=!0,this.domCache=new Map,this.cleanupHandlers=[],this.init()}init(){window.Utils.ready(()=>{this.setupNavigation(),this.setupMobileMenu(),this.setupVideoGallery(),this.setupRandomImages(),this.setupScrollAnimations(),this.setupPortfolioFilters(),this.setupContactForm(),this.setupIntersectionObserver(),this.loadUserPreferences()})}setupNavigation(){const t=window.Utils.$$(".nav-dot");window.Utils.$$("section[id]");t.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const o=t.getAttribute("href").substring(1),n=window.Utils.$(`#${o}`);n&&(this.smoothScrollTo(n),this.updateActiveNavDot(o))})});const e=window.Utils.throttle(()=>{this.updateActiveNavDotOnScroll()},100);window.addEventListener("scroll",e),this.updateActiveNavDotOnScroll()}setupMobileMenu(){const t=window.Utils.$("#mobileMenuTrigger"),e=window.Utils.$("#mobileMenu"),o=window.Utils.$$(".mobile-menu-item");t&&e&&(t.addEventListener("click",()=>{const t="flex"===e.style.display;this.toggleMobileMenu(!t)}),o.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const o=t.getAttribute("href").substring(1),n=window.Utils.$(`#${o}`);n&&(this.toggleMobileMenu(!1),setTimeout(()=>{this.smoothScrollTo(n)},300))})}),e.addEventListener("click",t=>{t.target===e&&this.toggleMobileMenu(!1)}))}toggleMobileMenu(t){const e=window.Utils.$("#mobileMenuTrigger"),o=window.Utils.$("#mobileMenu"),n=e.querySelectorAll("span");t?(o.style.display="flex",document.body.style.overflow="hidden",n[0].style.transform="rotate(45deg) translate(5px, 5px)",n[1].style.opacity="0",n[2].style.transform="rotate(-45deg) translate(7px, -6px)"):(o.style.display="none",document.body.style.overflow="",n.forEach(t=>{t.style.transform="",t.style.opacity=""}))}setupVideoGallery(){const t=window.Utils.$("#heroVideo");if(!t)return;const e=Math.floor(Math.random()*this.allVideos.length),o=this.allVideos[e];t.src=`images/${o}`,t.load(),t.play().catch(()=>{}),t.addEventListener("click",()=>{t.paused?t.play():t.pause()})}setupRandomImages(){const t=window.Utils.$(".image-card img");if(t&&this.images.length>0){const e=this.images[Math.floor(Math.random()*this.images.length)];t.src=`images/${e}`}window.Utils.$$('.portfolio-item[data-category="photo"] img').forEach(t=>{if(this.images.length>0){const e=this.images[Math.floor(Math.random()*this.images.length)];t.src=`images/${e}`}})}setupPortfolioFilters(){const t=window.Utils.$$(".filter-btn"),e=window.Utils.$$(".portfolio-item");t.forEach(o=>{o.addEventListener("click",()=>{const n=o.getAttribute("data-filter");t.forEach(t=>t.classList.remove("active")),o.classList.add("active"),e.forEach(t=>{const e=t.getAttribute("data-category");"all"===n||e===n?(t.style.display="block",t.style.animation="fadeInUp 0.6s ease-out"):t.style.display="none"})})})}setupContactForm(){const t=window.Utils.$("#contactForm");if(!t)return;const e=t.querySelectorAll("input, textarea"),o=t.querySelector(".submit-button");e.forEach(t=>{t.addEventListener("focus",()=>{t.parentNode.classList.add("focused")}),t.addEventListener("blur",()=>{t.value.trim()||t.parentNode.classList.remove("focused"),this.validateField(t)}),t.addEventListener("input",window.Utils.debounce(()=>{t.classList.contains("error")&&this.validateField(t)},300))}),t.addEventListener("submit",async e=>{e.preventDefault(),await this.handleFormSubmit(t,o)})}setupCursorFollow(){if(window.innerWidth<config.UI.MOBILE_BREAKPOINT)return;const t=this.createCustomCursor();this.setupCursorMovement(t),this.setupCursorInteractions(t)}createCustomCursor(){const t=document.createElement("div");return t.className="custom-cursor",t.style.cssText=`\n            position: fixed;\n            width: 20px;\n            height: 20px;\n            background: ${config.UI.CURSOR_COLORS.DEFAULT};\n            border-radius: 50%;\n            pointer-events: none;\n            z-index: 9999;\n            mix-blend-mode: difference;\n            transition: transform 0.1s ease;\n        `,document.body.appendChild(t),t}setupCursorMovement(t){const e=e=>{t.style.left=e.clientX-10+"px",t.style.top=e.clientY-10+"px"};document.addEventListener("mousemove",e),this.cleanupHandlers.push(()=>{document.removeEventListener("mousemove",e),t.remove()})}setupCursorInteractions(t){window.Utils.$$(config.SELECTORS.INTERACTIVE_ELEMENTS).forEach(e=>{const o=()=>{t.style.transform="scale(2)",t.style.background=config.UI.CURSOR_COLORS.HOVER},n=()=>{t.style.transform="scale(1)",t.style.background=config.UI.CURSOR_COLORS.DEFAULT};e.addEventListener("mouseenter",o),e.addEventListener("mouseleave",n),this.cleanupHandlers.push(()=>{e.removeEventListener("mouseenter",o),e.removeEventListener("mouseleave",n)})})}setupScrollAnimations(){const t=window.Utils.$$(".service-card, .portfolio-item, .stat, .contact-card, .image-card"),e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.style.opacity="1",t.target.style.transform="translateY(0)",t.target.style.transition="all 0.6s cubic-bezier(0.23, 1, 0.320, 1)")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});t.forEach(t=>{t.style.opacity="0",t.style.transform="translateY(30px)",e.observe(t)})}setupIntersectionObserver(){const t=window.Utils.$$("section[id]"),e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const e=t.target.getAttribute("id");this.updateActiveNavDot(e)}})},{threshold:.5});t.forEach(t=>{e.observe(t)})}updateActiveNavDot(t){window.Utils.$$(".nav-dot").forEach(e=>{e.classList.remove("active");e.getAttribute("href")===`#${t}`&&e.classList.add("active")})}updateActiveNavDotOnScroll(){const t=window.Utils.$$("section[id]");let e="";t.forEach(t=>{const o=t.offsetTop-200,n=t.offsetHeight;window.scrollY>=o&&window.scrollY<o+n&&(e=t.getAttribute("id"))}),e&&this.updateActiveNavDot(e)}smoothScrollTo(t){const e=t.offsetTop-50,o=window.pageYOffset,n=e-o;let i=null;const s=t=>{null===i&&(i=t);const e=t-i,r=this.easeInOutCubic(e,o,n,1e3);window.scrollTo(0,r),e<1e3&&requestAnimationFrame(s)};requestAnimationFrame(s)}easeInOutCubic(t,e,o,n){return(t/=n/2)<1?o/2*t*t*t+e:o/2*((t-=2)*t*t+2)+e}validateField(t){const e=t.value.trim(),o=t.getAttribute("name");let n=!0,i="";return this.clearFieldError(t),t.hasAttribute("required")&&!window.Utils.validators.required(e)&&(n=!1,i=config.VALIDATION.ERROR_MESSAGES.REQUIRED),"email"===o&&e&&!window.Utils.validators.email(e)&&(n=!1,i=config.VALIDATION.ERROR_MESSAGES.INVALID_EMAIL),"message"===o&&e&&!window.Utils.validators.minLength(e,config.VALIDATION.MESSAGE_MIN_LENGTH)&&(n=!1,i=config.VALIDATION.ERROR_MESSAGES.MESSAGE_TOO_SHORT),n||this.showFieldError(t,i),n}clearFieldError(t){t.classList.remove("error");const e=t.parentNode.querySelector(".field-error");e&&e.remove()}showFieldError(t,e){t.classList.add("error");const o=document.createElement("div");o.className="field-error",o.textContent=e,o.style.cssText="\n            color: #ff6b6b;\n            font-size: 0.8rem;\n            margin-top: 0.5rem;\n            position: absolute;\n            bottom: -1.5rem;\n            left: 0;\n        ",t.parentNode.style.position="relative",t.parentNode.appendChild(o)}async handleFormSubmit(t,e){const o=new FormData(t),n=Object.fromEntries(o.entries());if(!this.validateAllFields(t))return void window.Utils.showNotification(config.FORM.VALIDATION_ERROR_MESSAGE,"error");const i=this.setLoadingState(e,!0);try{await new Promise(t=>setTimeout(t,config.FORM.SUBMISSION_DELAY)),this.handleSubmissionSuccess(t,n)}catch(t){this.handleSubmissionError()}finally{this.setLoadingState(e,!1,i)}}validateAllFields(t){const e=t.querySelectorAll("input, textarea");let o=!0;return e.forEach(t=>{this.validateField(t)||(o=!1)}),o}setLoadingState(t,e,o=null){const n=t.querySelector("span");if(e){const e=n.textContent;return n.textContent=config.FORM.LOADING_TEXT,t.disabled=!0,t.style.opacity=config.UI.LOADING_OPACITY,e}n.textContent=o,t.disabled=!1,t.style.opacity="1"}handleSubmissionSuccess(t,e){window.Utils.showNotification(config.FORM.SUCCESS_MESSAGE,"success"),t.reset(),window.Utils.storage.set(config.STORAGE.CONTACT_DATA_KEY,{name:e.name,email:e.email,timestamp:Date.now()})}handleSubmissionError(){window.Utils.showNotification(config.FORM.ERROR_MESSAGE,"error")}loadUserPreferences(){this.loadSavedContactData(),this.setupAccessibilityPreferences(),this.setupThemePreferences()}loadSavedContactData(){const t=window.Utils.storage.get(config.STORAGE.CONTACT_DATA_KEY);if(!t||!this.isContactDataValid(t))return;const e=window.Utils.$("#name"),o=window.Utils.$("#email");e&&!e.value&&(e.value=t.name||""),o&&!o.value&&(o.value=t.email||"")}isContactDataValid(t){return Date.now()-t.timestamp<config.STORAGE.CONTACT_DATA_EXPIRY}setupAccessibilityPreferences(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&document.documentElement.style.setProperty("--transition","none")}setupThemePreferences(){const t=window.matchMedia("(prefers-color-scheme: dark)"),e=()=>{document.body.classList.toggle("dark-mode",t.matches)};e(),t.addListener(e),this.cleanupHandlers.push(()=>{t.removeListener(e)})}getCachedElement(t,e=null){const o=e||t;if(!this.domCache.has(o)){const e=$(t);this.domCache.set(o,e)}return this.domCache.get(o)}clearCache(){this.domCache.clear()}destroy(){this.cleanupHandlers.forEach(t=>{try{t()}catch(t){}}),this.cleanupHandlers.length=0,this.clearCache()}}const app=new XylocopeModern;window.XylocopeApp=app,window.Utils.ready(()=>{if(!window.Utils.$("#dynamic-styles")){const t=document.createElement("style");t.id="dynamic-styles",t.textContent="\n            .field-error {\n                color: #ff6b6b;\n                font-size: 0.8rem;\n                margin-top: 0.5rem;\n                position: absolute;\n                bottom: -1.5rem;\n                left: 0;\n            }\n            \n            .input-container.error input,\n            .input-container.error textarea {\n                border-color: #ff6b6b;\n                box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);\n            }\n            \n            .notification {\n                position: fixed;\n                top: 2rem;\n                right: 2rem;\n                background: var(--glass-bg);\n                backdrop-filter: blur(20px);\n                border: 1px solid var(--glass-border);\n                border-radius: 15px;\n                padding: 1rem 1.5rem;\n                color: var(--text-primary);\n                z-index: 10000;\n                transform: translateX(100%);\n                transition: transform 0.3s ease;\n            }\n            \n            .notification.show {\n                transform: translateX(0);\n            }\n            \n            .notification.success {\n                border-left: 4px solid #4ade80;\n            }\n            \n            .notification.error {\n                border-left: 4px solid #ef4444;\n            }\n            \n            @media (max-width: 768px) {\n                .notification {\n                    top: 1rem;\n                    right: 1rem;\n                    left: 1rem;\n                    transform: translateY(-100%);\n                }\n                \n                .notification.show {\n                    transform: translateY(0);\n                }\n            }\n        ",document.head.appendChild(t)}});